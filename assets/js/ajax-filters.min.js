jQuery(document).ready(function(i){function e(e,a){if($supports_html5_history){var t=e.find(".classified_filters"),n=i(t).serialize(),r=i("div.classified_listings").index(e);window.history.replaceState({id:"classified_manager_state",page:a,data:n,index:r},"",s+"#s=1")}}var a=[];console.log("test"),i(".classified_listings").on("update_results",function(e,s,t,n){var r="",l=i(this),o=l.find(".classified_filters"),d=l.find(".showing_classifieds"),c=l.find(".classified_listings"),_=l.data("per_page"),f=l.data("per_row"),g=l.data("orderby"),h=l.data("order"),p=l.data("featured"),u=l.data("unavailable"),m=i("div.classified_listings").index(this);if(!(0>m)){if(a[m]&&a[m].abort(),t||(i(c).addClass("loading"),i("li.classified_listing, li.no_classified_listings_found",c).css("visibility","hidden"),s>1&&1!=l.data("show_pagination")?i(c).before('<a class="load_more_classifieds load_previous" href="#"><strong>'+classified_manager_ajax_filters.i18n_load_prev_listings+"</strong></a>"):l.find(".load_previous").remove(),l.find(".load_more_classifieds").data("page",s)),1==l.data("show_filters")){var v=[];i(':input[name="filter_classified_type[]"]:checked, :input[name="filter_classified_type[]"][type="hidden"], :input[name="filter_classified_type"]',o).each(function(){v.push(i(this).val())});var w=o.find(':input[name^="search_categories"]').map(function(){return i(this).val()}).get(),y="",b="",k=o.find(':input[name="search_keywords"]'),x=o.find(':input[name="search_location"]');k.val()!==k.attr("placeholder")&&(y=k.val()),x.val()!==x.attr("placeholder")&&(b=x.val()),r={lang:classified_manager_ajax_filters.lang,search_keywords:y,search_location:b,search_categories:w,filter_classified_type:v,per_page:_,per_row:f,orderby:g,order:h,page:s,featured:p,unavailable:u,show_pagination:l.data("show_pagination"),form_data:o.serialize()}}else{var w=l.data("categories"),y=l.data("keywords"),b=l.data("location");w&&(w=w.split(",")),r={lang:classified_manager_ajax_filters.lang,search_categories:w,search_keywords:y,search_location:b,per_page:_,per_row:f,orderby:g,order:h,page:s,featured:p,unavailable:u,show_pagination:l.data("show_pagination")}}a[m]=i.ajax({type:"POST",url:classified_manager_ajax_filters.ajax_url.toString().replace("%%endpoint%%","get_listings"),data:r,success:function(e){if(e)try{e.showing?i(d).show().html("<span>"+e.showing+"</span>"+e.showing_links):i(d).hide(),e.showing_all?i(d).addClass("wp-classified-manager-showing-all"):i(d).removeClass("wp-classified-manager-showing-all"),e.html&&(t&&n?i(c).prepend(e.html):t?i(c).append(e.html):i(c).html(e.html)),1==l.data("show_pagination")?(l.find(".classified-manager-pagination").remove(),e.pagination&&l.append(e.pagination)):(!e.found_classifieds||e.max_num_pages<=s?i(".load_more_classifieds:not(.load_previous)",l).hide():n||i(".load_more_classifieds",l).show(),i(".load_more_classifieds",l).removeClass("loading"),i("li.classified_listing",c).css("visibility","visible")),i(c).removeClass("loading"),l.triggerHandler("updated_results",e)}catch(a){window.console&&console.log(a)}},error:function(i,e,a){window.console&&"abort"!==e&&console.log(e+": "+a)},statusCode:{404:function(){window.console&&console.log("Error 404: Ajax Endpoint cannot be reached. Go to Settings > Permalinks and save to resolve.")}}})}}),i("#search_keywords, #search_location, .classified_types :input, #search_categories, .classified-manager-filter").change(function(){var a=i(this).closest("div.classified_listings");a.triggerHandler("update_results",[1,!1]),e(a,1)}).on("keyup",function(e){13===e.which&&i(this).trigger("change")}),i(".classified_filters").on("click",".reset",function(){var a=i(this).closest("div.classified_listings"),s=i(this).closest("form");return s.find(':input[name="search_keywords"], :input[name="search_location"], .classified-manager-filter').not(':input[type="hidden"]').val("").trigger("chosen:updated"),s.find(':input[name^="search_categories"]').not(':input[type="hidden"]').val(0).trigger("chosen:updated"),i(':input[name="filter_classified_type[]"]',s).not(':input[type="hidden"]').attr("checked","checked"),a.triggerHandler("reset"),a.triggerHandler("update_results",[1,!1]),e(a,1),!1}),i(document.body).on("click",".load_more_classifieds",function(){var a=i(this).closest("div.classified_listings"),s=parseInt(i(this).data("page")||1),t=!1;return i(this).addClass("loading"),i(this).is(".load_previous")?(s-=1,t=!0,1===s?i(this).remove():i(this).data("page",s)):(s+=1,i(this).data("page",s),e(a,s)),a.triggerHandler("update_results",[s,!0,t]),!1}),i("div.classified_listings").on("click",".classified-manager-pagination a",function(){var a=i(this).closest("div.classified_listings"),s=i(this).data("page");return e(a,s),a.triggerHandler("update_results",[s,!1]),i("body, html").animate({scrollTop:a.offset().top},600),!1}),i.isFunction(i.fn.chosen)&&(1==classified_manager_ajax_filters.is_rtl&&i('select[name^="search_categories"]').addClass("chosen-rtl"),i('select[name^="search_categories"]').chosen({search_contains:!0})),window.history&&window.history.pushState?$supports_html5_history=!0:$supports_html5_history=!1;var s=document.location.href.split("#")[0];i(window).on("load",function(e){i(".classified_filters").each(function(){var e=i(this).closest("div.classified_listings"),a=e.find(".classified_filters"),s=1,t=i("div.classified_listings").index(e);if(window.history.state&&window.location.hash){var n=window.history.state;n.id&&"classified_manager_state"===n.id&&t==n.index&&(s=n.page,a.deserialize(n.data),a.find(':input[name^="search_categories"]').not(':input[type="hidden"]').trigger("chosen:updated"))}e.triggerHandler("update_results",[s,!1])})})});