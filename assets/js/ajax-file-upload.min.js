jQuery(function(e){e(".wp-classified-manager-file-upload").each(function(){e(this).fileupload({dataType:"json",dropZone:e(this),url:classified_manager_ajax_file_upload.ajax_url.toString().replace("%%endpoint%%","upload_file"),maxNumberOfFiles:1,formData:{script:!0},add:function(a,i){var l=e(this),t=l.closest("form"),r=l.parent().find(".classified-manager-uploaded-files"),n=[],s=e(this).data("file_types");if(s){var d=new RegExp("(.|/)("+s+")$","i");i.originalFiles[0].name.length&&!d.test(i.originalFiles[0].name)&&n.push(classified_manager_ajax_file_upload.i18n_invalid_file_type+" "+s)}i.originalFiles[0].size>classified_manager_ajax_file_upload.max_file_size&&n.push(classified_manager_ajax_file_upload.i18n_file_size_exceeded),n.length>0?alert(n.join("\n")):(t.find(':input[type="submit"]').attr("disabled","disabled"),i.context=e('<progress value="" max="100"></progress>').appendTo(r),i.submit())},progress:function(a,i){var l=e(this),t=(l.parent().find(".classified-manager-uploaded-files"),parseInt(i.loaded/i.total*100,10));i.context.val(t)},fail:function(a,i){var l=e(this),t=l.closest("form");i.errorThrown&&alert(i.errorThrown),i.context.remove(),t.find(':input[type="submit"]').removeAttr("disabled")},done:function(a,i){var l=e(this),t=l.closest("form"),r=l.parent().find(".classified-manager-uploaded-files"),n=l.attr("multiple")?1:0,s=["jpg","gif","png","jpeg","jpe"];i.context.remove(),e.each(i.result.files,function(a,i){if(i.error)alert(i.error);else{if(e.inArray(i.extension,s)>=0){var t=e.parseHTML(classified_manager_ajax_file_upload.js_field_html_img);e(t).find(".classified-manager-uploaded-file-preview img").attr("src",i.url)}else{var t=e.parseHTML(classified_manager_ajax_file_upload.js_field_html);e(t).find(".classified-manager-uploaded-file-name code").text(i.name)}e(t).find(".input-text").val(i.url),e(t).find(".input-text").attr("name","current_"+l.attr("name")),n?r.append(t):r.html(t)}}),t.find(':input[type="submit"]').removeAttr("disabled")}})})});